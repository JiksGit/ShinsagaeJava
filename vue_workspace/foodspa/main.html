<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Document</title>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
        <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    </head>
<style>
    #app{
        width : 1400px;
        height : 800px;
        background-color: rgb(181, 188, 255);
    }
    #content_header {
        width : 100%;
        height : 50px;
        background-color: rgba(255, 228, 196, 0.527);
        text-align: center;
    }
    #content_body {
        width: 100%;
        height: 750px;
        background-color: bisque;
    }
    input {
        width: 30%;
        height: 30px;
    }
    button {
        width: 60px;
        height: 30px;
        margin-top: 7px;
        margin-left : 5px;
    }
    table {
        width: 100%;
    }
</style>
<body>
    <div id="app">
        <div id="content_header">
            <input type="text" placeholder="상호명 검색">
            <button type="button">검색</button>
        </div>
        <div id="content_body">
            <table>
                <tr>
                    <th>상호명</th>
                    <th>연락처</th>
                    <th>위도</th>
                    <th>경도</th>
                    <th>관할지역</th>
                    <th>대표메뉴</th>
                    <th>소개</th>
                </tr>
                <tr v-for = "store in storeList">
                    <td>{{store.CMPNM}}</td>
                    <td>{{store.TELNO}}</td>
                    <td>{{store.LA}}</td>
                    <td>{{store.LO}}</td>
                    <td>{{store.SIGUN}}</td>
                    <td>{{store.MNMNU}}</td>
                    <td>{{store.DC}}</td>
                </tr>
            </table>    
        </div>
    </div>

    <script>
        const {createApp, reactive, ref} = Vue;
        
        // Vue3부터는 setup() 메서드 안에 필요한 변수 및 메서드를 한꺼번에 등록한다
        // 단, 등록된 변수 및 메서드는 Vue에게 반환(return)
        createApp({
            setup(){
                let msg = ref(0); // 바인딩 데이터 선언
                const storeList = reactive([]); // 바인딩 배열 선언

                // 음식 목록 요청 메서드 정의
                const getList=(store_name)=>{
                    store_name = (store_name == undefined) ? "" : store_name;
                    $.ajax({
                        url: "http://localhost:7777/food/stores?store_name=" + store_name,
                        method: "GET",
                        dataType: "json", // ← 응답을 자동으로 JS 객체/배열로 변환
                        success: result => {
                            // console.log("서버로부터 받은 음식점 목록은:", result);
                            console.log("서버로부터 받은 음식점 바디는:", result.body);
                            storeList.splice(0); // removeAll()
                            result.body.forEach((item)=>{
                                storeList.push(item);
                            });

                        }
                    });
                }

                getList();

                return {msg, storeList, getList};
            }
        }).mount("#app");
    </script>
</body>
</html>